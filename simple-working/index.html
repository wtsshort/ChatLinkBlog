<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>WTSSHORT - مولد روابط واتساب</title>
    <meta name="description" content="أداة مجانية لإنشاء روابط واتساب مع رسائل جاهزة" />
    <style>
      * { margin: 0; padding: 0; box-sizing: border-box; }
      body { font-family: 'Arial', sans-serif; background: #f8fafc; direction: rtl; color: #374151; }
      .container { max-width: 1000px; margin: 0 auto; padding: 20px; }
      .header { text-align: center; margin-bottom: 40px; }
      .logo { color: #25D366; font-size: 2.5rem; font-weight: bold; margin-bottom: 10px; }
      .subtitle { color: #64748b; font-size: 1.1rem; line-height: 1.6; }
      .stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin: 30px 0; }
      .stat-card { background: white; padding: 25px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); text-align: center; }
      .stat-number { font-size: 2rem; font-weight: bold; color: #25D366; display: block; margin-bottom: 5px; }
      .stat-label { color: #64748b; font-size: 0.9rem; }
      .generator { background: white; padding: 30px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin: 20px 0; }
      .section-title { color: #374151; margin-bottom: 25px; text-align: center; font-size: 1.3rem; }
      .form-group { margin-bottom: 20px; }
      .label { display: block; margin-bottom: 8px; color: #374151; font-weight: 500; }
      .input, .textarea { width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem; }
      .input:focus, .textarea:focus { border-color: #25D366; outline: none; }
      .textarea { resize: vertical; font-family: inherit; }
      .button { background: #25D366; color: white; padding: 12px 30px; border: none; border-radius: 8px; font-size: 1rem; cursor: pointer; font-weight: 500; width: 100%; }
      .button:hover { background: #1da851; }
      .result { margin-top: 20px; padding: 20px; background: #f0fdf4; border-radius: 8px; border-right: 4px solid #25D366; display: none; }
      .link-result { color: #25D366; word-break: break-all; font-weight: 500; font-size: 1.1rem; margin: 10px 0; }
      .tests { margin-top: 30px; text-align: center; }
      .test-links { display: flex; flex-wrap: wrap; justify-content: center; gap: 15px; margin-top: 20px; }
      .test-link { padding: 10px 20px; background: #25D366; color: white; text-decoration: none; border-radius: 6px; font-size: 0.9rem; }
      .test-link:hover { background: #1da851; }
      .footer { text-align: center; margin-top: 50px; padding-top: 30px; border-top: 1px solid #e5e7eb; color: #64748b; }
      
      @media (max-width: 768px) {
        .container { padding: 15px; }
        .logo { font-size: 2rem; }
        .generator { padding: 20px; }
        .test-links { flex-direction: column; align-items: center; }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header class="header">
        <div class="logo">🔗 WTSSHORT</div>
        <div class="subtitle">أداة مجانية لإنشاء روابط واتساب مع رسائل جاهزة<br>ابدأ محادثات واتساب فورية مع عملائك</div>
      </header>

      <div class="stats">
        <div class="stat-card">
          <span class="stat-number" id="totalLinks">3</span>
          <div class="stat-label">الروابط المُنشأة</div>
        </div>
        <div class="stat-card">
          <span class="stat-number" id="totalClicks">1,450</span>
          <div class="stat-label">إجمالي النقرات</div>
        </div>
        <div class="stat-card">
          <span class="stat-number" id="totalPosts">2</span>
          <div class="stat-label">مقالات المدونة</div>
        </div>
        <div class="stat-card">
          <span class="stat-number" id="totalViews">850</span>
          <div class="stat-label">مشاهدات المقالات</div>
        </div>
      </div>

      <div class="generator">
        <h2 class="section-title">📱 إنشاء رابط واتساب جديد</h2>
        <form id="linkForm">
          <div class="form-group">
            <label class="label">رقم الهاتف مع رمز الدولة</label>
            <input type="tel" class="input" placeholder="+966501234567" id="phoneNumber" required>
            <small style="color: #64748b;">مثال: +966501234567 أو +971501234567</small>
          </div>
          <div class="form-group">
            <label class="label">نص الرسالة المُعدة مسبقاً</label>
            <textarea class="textarea" rows="4" placeholder="مرحباً! كيف يمكنني مساعدتك؟" id="message" required></textarea>
            <small style="color: #64748b;">هذه الرسالة ستظهر جاهزة للإرسال عند فتح واتساب</small>
          </div>
          <div class="form-group">
            <label class="label">رابط مخصص (اختياري)</label>
            <input type="text" class="input" placeholder="my-store" id="customSlug">
            <small style="color: #64748b;">سيصبح الرابط: yoursite.com/s/my-store</small>
          </div>
          <button type="submit" class="button">🚀 إنشاء رابط واتساب</button>
        </form>
        
        <div id="result" class="result">
          <strong>✅ تم إنشاء الرابط بنجاح!</strong><br>
          <div class="link-result" id="generatedLink"></div>
          <p style="margin-top: 10px; color: #16a34a; text-align: center;">
            🎉 يمكنك الآن مشاركة هذا الرابط مع العملاء لبدء محادثة واتساب مباشرة
          </p>
        </div>
      </div>

      <div class="tests">
        <h3 class="section-title">🧪 اختبار الميزات</h3>
        <div class="test-links">
          <a href="/api/test" target="_blank" class="test-link">🔧 اختبار API</a>
          <a href="/s/hello" target="_blank" class="test-link">👋 رابط ترحيب</a>
          <a href="/s/store" target="_blank" class="test-link">🏪 رابط متجر</a>
          <a href="https://wa.me/966501234567?text=%D9%85%D8%B1%D8%AD%D8%A8%D8%A7%D9%8B" target="_blank" class="test-link">📱 واتساب مباشر</a>
        </div>
        <p style="margin-top: 15px; color: #64748b; text-align: center; font-size: 0.9rem;">
          إذا عملت الروابط أعلاه، فالمشروع يعمل بنجاح! ✅
        </p>
      </div>

      <footer class="footer">
        <p><strong>WTSSHORT</strong> - أداة مجانية لإنشاء روابط واتساب</p>
        <p>صُنع بـ ❤️ للمستخدمين العرب | © 2024</p>
      </footer>
    </div>

    <script>
      // Form handling
      document.getElementById('linkForm').addEventListener('submit', function(e) {
        e.preventDefault();
        
        const phoneNumber = document.getElementById('phoneNumber').value.trim();
        const message = document.getElementById('message').value.trim();
        const customSlug = document.getElementById('customSlug').value.trim();
        
        if (!phoneNumber || !message) {
          alert('⚠️ يرجى ملء رقم الهاتف والرسالة');
          return;
        }

        // Validate phone number
        if (!phoneNumber.startsWith('+')) {
          alert('⚠️ يرجى إضافة رمز الدولة مع علامة + (مثال: +966)');
          return;
        }

        try {
          // Generate WhatsApp link
          const cleanNumber = phoneNumber.replace(/[^+\d]/g, '').replace('+', '');
          const encodedMessage = encodeURIComponent(message);
          const whatsappLink = `https://wa.me/${cleanNumber}?text=${encodedMessage}`;
          
          // Show result
          document.getElementById('generatedLink').textContent = whatsappLink;
          document.getElementById('result').style.display = 'block';
          
          // Scroll to result smoothly
          setTimeout(() => {
            document.getElementById('result').scrollIntoView({ 
              behavior: 'smooth',
              block: 'center'
            });
          }, 100);
          
          // Copy to clipboard
          navigator.clipboard.writeText(whatsappLink).then(() => {
            console.log('Link copied to clipboard');
          }).catch(err => {
            console.log('Could not copy link');
          });

        } catch (error) {
          alert('❌ حدث خطأ في إنشاء الرابط، يرجى المحاولة مرة أخرى');
          console.error('Error generating link:', error);
        }
      });

      // Test API connection
      async function testAPI() {
        try {
          const response = await fetch('/api/test');
          if (response.ok) {
            const data = await response.json();
            console.log('✅ API Connected:', data);
          } else {
            console.log('❌ API Error:', response.status);
          }
        } catch (error) {
          console.log('❌ API Connection failed:', error);
        }
      }

      // Run tests on page load
      window.addEventListener('load', () => {
        testAPI();
        console.log('🚀 WTSSHORT loaded successfully');
      });
    </script>
  </body>
</html>